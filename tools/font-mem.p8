pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
--font memory mapper
--@oakreef

fontheight = 8
firstfontwidth = 8
secondfontwidth = 8

filename = "@clip"

--reset font memory
memset(0x5600,0,2048)

poke(0x5600,
	firstfontwidth,
	secondfontwidth,
	fontheight)

--read spritesheet font into memory
for i=1,255 do
	for z=0,1 do
		local g = "0b"
		for y=3,0,-1 do
			if y==1 then
				g..="."
			end
			for x=7,0,-1 do
				local p=sget(x+(i%16)*8,
														y+flr(i/16)*8+z*4)
				g..= (p>0 and 1 or 0)
			end
		end
		poke4(
			0x5600+i*8+4*z,
			tonum(g))
	end
end

--draw font to screen
cls()
for i=16,255 do
	print("\014"..chr(i),
		i%16*8,
		flr(i/16-1)*8,
		6)
end


function compress_hex(str)
	if tonum(str) == 0 then
		return "0"
	end
	
	d1,d2=nil,nil
	dot=false
	for i=3,#str do
		local digit=sub(str,i,i)
		if digit=='.' then
			dot=true
		elseif dot then
			if digit!="0" then
				d2=i
			end
		else
			if not d1 and digit !="0" then
				d1=i
			end
		end
	end
	
	d1=d1 or 7
	d2=d2 or 6
	
	return "0x"..sub(str,d1,d2)
end

memstart=nil
memend=nil
for i=1,511 do
	if peek4(0x5600+i*4) != 0 then
		memend = i
		if memstart == nil then
			memstart = i
		end
	end
end

o4="poke4(unpack(split\""

o4..=sub(tostr(0x5600+4*memstart,true),1,6)
for i=memstart,memend,1 do
	local adr=0x5600+i*4
	local val=peek4(adr)
	
	local str
	
	if val == 0 then
		str = ""
	else
		str = compress_hex(tostr(val,true))
	end
	
	o4..=","..str
end
o4..="\"))"



o1="poke(unpack(split\""

o1..=sub(tostr(0x5600+4*memstart,true),1,6)
for i=memstart*4,memend*4,1 do
	local adr=0x5600+i
	local val=peek(adr)
	
	local str
	
	if val == 0 then
		str = ""
	else
		str = val
	end
	
	o1..=","..str
end
o1..="\"))"


--is poke or poke4 smaller?
out=#o4<#o1 and o4 or o1

printh(out,filename,false)

rectfill(0,121,127,127,1)
print('copied font loader to clipboard!',1,122,6)


function _update() end


__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000060000006060000060600000006000006060000000000000060000000000000000000000000000000000000000000000000000000000000000000000
00000000060000006060000066600000060000000060000066600000600000000600000006000000060000000600000000000000000000000000000000600000
00000000060000000000000060600000666000000600000000600000000000006000000000600000666000006660000000000000666000000000000006000000
00000000000000000000000066600000060000006000000006000000000000006000000000600000060000000600000000000000000000000000000006000000
00000000060000000000000060600000006000006060000060000000000000000600000006000000606000000000000006000000000000000600000060000000
00000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000060000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000600000000000006000000066600000
66600000660000006660000066600000066000006660000066600000666000006660000066600000060000000600000006000000666000000600000000600000
60600000060000000660000006600000606000006600000060600000006000006660000060600000000000000000000060000000000000000060000006600000
60600000060000006000000000600000666000000060000060600000006000006060000060600000060000000600000006000000666000000600000000000000
66600000666000006660000066600000006000006660000066600000006000006660000066600000000000006000000000600000000000006000000006000000
00000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000
00000000007000000700000000000000070000000070000000000000000000000000000000700000000000000000000000000000000000000000000000700000
00000000070000000000000007000000000000000700000007000000070000000000000007000000000000000000000000000000070000000000000007000000
06000000000000006000000000000000666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60600000066000006660000006600000066000006660000066600000666000000000000066600000000000000000000000000000666000000000000006600000
60600000606000006060000060000000606000006600000060000000060000000000000006000000000000000000000000000000666000000000000060600000
60000000666000006060000060000000606000006000000066000000006000000000000006000000000000000000000000000000606000000000000060600000
06600000606000006600000006600000660000000660000060000000606000000000000066600000000000000000000000000000606000000000000066000000
00000000000000000000000000000000000000000000000060000000660000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07000000000000000000000007000000070000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000
66600000000000000000000006600000666000006060000000000000000000000000000000000000000000006600000060000000066000006060000000000000
60600000000000000000000060000000600000006060000000000000000000000000000000000000000000006000000006000000006000000000000000000000
66000000000000000000000000600000600000006060000000000000000000000000000000000000000000006000000006000000006000000000000000000000
60000000000000000000000066000000060000000660000000000000000000000000000000000000000000006600000000600000066000000000000066600000
60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06000000000000006000000000000000666000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000
00600000066000006660000006600000066000006660000066600000666000006660000066600000666000006060000060000000666000006600000006600000
00000000606000006060000060000000606000006600000060000000060000006060000006000000060000006060000060000000666000006060000060600000
00000000666000006060000060000000606000006000000066000000006000006060000006000000060000006600000060000000606000006060000060600000
00000000606000006600000006600000660000000660000060000000606000006060000066600000060000006060000006600000606000006060000066000000
00000000000000000000000000000000000000000000000060000000660000000000000000000000660000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000660000006000000660000000000000000000000
66600000066000006600000006600000666000006060000060600000606000006060000060600000666000000600000006000000060000000060000000000000
60600000606000006060000060000000600000006060000060600000606000006060000060600000006000006600000006000000066000006660000000000000
66000000606000006060000000600000600000006060000066600000666000000600000006000000600000000600000006000000060000006000000000000000
60000000660000006000000066000000060000000660000006000000666000006060000006000000666000000660000006000000660000000000000000000000
60000000006000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000060000006060000060600000006000006060000000000000060000000000000000000000000000000000000000000000000000000000000000000000
00000000060000006060000066600000060000000060000066600000600000000600000006000000060000000600000000000000000000000000000000600000
00000000060000000000000060600000666000000600000000600000000000006000000000600000666000006660000000000000666000000000000006000000
00000000000000000000000066600000060000006000000006000000000000006000000000600000060000000600000000000000000000000000000006000000
00000000060000000000000060600000006000006060000060000000000000000600000006000000606000000000000006000000000000000600000060000000
00000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000060000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000600000000000006000000066600000
66600000660000006660000066600000066000006660000066600000666000006660000066600000060000000600000006000000666000000600000000600000
60600000060000000660000006600000606000006600000060600000006000006660000060600000000000000000000060000000000000000060000006600000
60600000060000006000000000600000666000000060000060600000006000006060000060600000060000000600000006000000666000000600000000000000
66600000666000006660000066600000006000006660000066600000006000006660000066600000000000006000000000600000000000006000000006000000
00000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000
00000000006000000600000000000000060000000060000000000000000000000000000000600000000000000000000000000000000000000000000000600000
00000000060000000000000006000000000000000600000006000000060000000000000006000000000000000000000000000000060000000000000006000000
06000000000000006000000000000000666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
60600000066000006660000006600000066000006660000066600000666000000000000066600000000000000000000000000000666000000000000006600000
60600000606000006060000060000000606000006600000060000000060000000000000006000000000000000000000000000000666000000000000060600000
60000000666000006060000060000000606000006000000066000000006000000000000006000000000000000000000000000000606000000000000060600000
06600000606000006600000006600000660000000660000060000000606000000000000066600000000000000000000000000000606000000000000066000000
00000000000000000000000000000000000000000000000060000000660000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06000000000000000000000006000000060000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000
66600000000000000000000006600000666000006060000000000000000000000000000000000000000000006600000060000000066000006060000000000000
60600000000000000000000060000000600000006060000000000000000000000000000000000000000000006000000006000000006000000000000000000000
66000000000000000000000000600000600000006060000000000000000000000000000000000000000000006000000006000000006000000000000000000000
60000000000000000000000066000000060000000660000000000000000000000000000000000000000000006600000000600000066000000000000066600000
60000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06000000000000006000000000000000666000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000
00600000066000006660000006600000066000006660000066600000666000006660000066600000666000006060000060000000666000006600000006600000
00000000606000006060000060000000606000006600000060000000060000006060000006000000060000006060000060000000666000006060000060600000
00000000666000006060000060000000606000006000000066000000006000006060000006000000060000006600000060000000606000006060000060600000
00000000606000006600000006600000660000000660000060000000606000006060000066600000060000006060000006600000606000006060000066000000
00000000000000000000000000000000000000000000000060000000660000000000000000000000660000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000660000006000000660000000000000000000000
66600000066000006600000006600000666000006060000060600000606000006060000060600000666000000600000006000000060000000060000000000000
60600000606000006060000060000000600000006060000060600000606000006060000060600000006000006600000006000000066000006660000000000000
66000000606000006060000000600000600000006060000066600000666000000600000006000000600000000600000006000000060000006000000000000000
60000000660000006000000066000000060000000660000006000000666000006060000006000000666000000660000006000000660000000000000000000000
60000000006000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11661166166616661666166111111666116616611666111116111166166616611666166611111666116611111166161116661666166611661666166616611161
16111616161611611611161611111611161616161161111116111616161616161611161611111161161611111611161111611616161616161616161616161161
16111616166611611661161611111661161616161161111116111616166616161661166111111161161611111611161111611666166116161666166116161161
16111616161111611611161611111611161616161161111116111616161616161611161611111161161611111611161111611611161616161616161616161111
11661661161116661666166611111611166116161161111116661661161616661666161611111161166111111166166616661611166616611616161616661161
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111

